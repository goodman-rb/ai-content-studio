# ๐ง ะะฐัััะพะนะบะฐ ะฐะฒัะพะฟัะฑะปะธะบะฐัะธะธ ัะตัะตะท N8N

ะะพะดัะพะฑะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ะฝะฐัััะพะนะบะต ะฐะฒัะพะผะฐัะธัะตัะบะพะน ะฟัะฑะปะธะบะฐัะธะธ ะฟะพััะพะฒ ะฒ VK ะธ Telegram.

---

## ๐ ะะณะปะฐะฒะปะตะฝะธะต

1. [ะงัะพ ัะฐะบะพะต N8N](#ััะพ-ัะฐะบะพะต-n8n)
2. [ะฃััะฐะฝะพะฒะบะฐ N8N ะปะพะบะฐะปัะฝะพ](#ัััะฐะฝะพะฒะบะฐ-n8n-ะปะพะบะฐะปัะฝะพ)
3. [ะะพะปััะตะฝะธะต API ัะพะบะตะฝะพะฒ](#ะฟะพะปััะตะฝะธะต-api-ัะพะบะตะฝะพะฒ)
4. [ะกะพะทะดะฐะฝะธะต Workflow](#ัะพะทะดะฐะฝะธะต-workflow)
5. [ะขะตััะธัะพะฒะฐะฝะธะต](#ัะตััะธัะพะฒะฐะฝะธะต)
6. [ะะฐะฟััะบ ะฒ ะฟัะพะดะฐะบัะฝ](#ะทะฐะฟััะบ-ะฒ-ะฟัะพะดะฐะบัะฝ)
7. [ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ](#ัะตัะตะฝะธะต-ะฟัะพะฑะปะตะผ)

---

## ๐ค ะงัะพ ัะฐะบะพะต N8N

**N8N** โ ััะพ ะฟะปะฐััะพัะผะฐ ะฐะฒัะพะผะฐัะธะทะฐัะธะธ ั ะพัะบััััะผ ะธััะพะดะฝัะผ ะบะพะดะพะผ (ะฐะฝะฐะปะพะณ Zapier/Make).

**ะะฐัะตะผ ะฝัะถะตะฝ ะดะปั AI Content Studio:**
- โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟัะฑะปะธะบะฐัะธั ะฟะพััะพะฒ ะฟะพ ัะฐัะฟะธัะฐะฝะธั
- โ ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธะน ัะตัะตะท YandexART
- โ ะัะฑะปะธะบะฐัะธั ะฒ VK ะธ Telegram ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
- โ ะะฑะฝะพะฒะปะตะฝะธะต ััะฐัััะฐ ะฒ Google Sheets

**ะััะธัะตะบัััะฐ:**
```
โโโโโโโโโโโโโโโโโโโ
โ  N8N Workflow   โ โ ะะฐะฟััะบะฐะตััั ะบะฐะถะดัะน ัะฐั
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Google Sheets           โ โ ะงะธัะฐะตั Content_Plan
โ ะคะธะปััั: Status = Ready  โ    ะณะดะต ะฒัะตะผั <= ัะตะนัะฐั
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ YandexART               โ โ ะะตะฝะตัะธััะตั ะบะฐััะธะฝะบั
โ (ะฟะพ Image_Prompt)       โ    ะฟะพ ะฟัะพะผะฟัั ะธะท ัะฐะฑะปะธัั
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
         โ
         โโโโโโโโโโโโโโโโโโโ
         โ                 โ
         โผ                 โผ
โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ
โ  VK API      โ   โ Telegram API โ โ ะัะฑะปะธะบะฐัะธั
โ  wall.post   โ   โ  sendPhoto   โ    ั ัะตะบััะพะผ
โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ
         โ                 โ
         โโโโโโโโโโฌโโโโโโโโโ
                  โผ
         โโโโโโโโโโโโโโโโโโโโโโโ
         โ Google Sheets       โ โ ะะฑะฝะพะฒะปะตะฝะธะต
         โ Status โ Published  โ    ััะฐัััะฐ
         โโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ณ ะฃััะฐะฝะพะฒะบะฐ N8N ะปะพะบะฐะปัะฝะพ

### ะะฐัะธะฐะฝั A: Docker (ะะตะบะพะผะตะฝะดัะตััั)

**ะขัะตะฑะพะฒะฐะฝะธั:**
- Docker Desktop ัััะฐะฝะพะฒะปะตะฝ ะธ ะทะฐะฟััะตะฝ

**ะจะฐะณ 1: ะะฐะฟััะบ N8N**

```bash
docker run -it --rm \
  --name n8n \
  -p 5678:5678 \
  -v n8n_data:/home/node/.n8n \
  docker.n8n.io/n8nio/n8n
```

**Windows (PowerShell):**
```powershell
docker run -it --rm `
  --name n8n `
  -p 5678:5678 `
  -v n8n_data:/home/node/.n8n `
  docker.n8n.io/n8nio/n8n
```

**ะงัะพ ะดะตะปะฐะตั:**
- `-p 5678:5678` โ N8N ะดะพัััะฟะตะฝ ะฝะฐ http://localhost:5678
- `-v n8n_data:/home/node/.n8n` โ ะดะฐะฝะฝัะต ัะพััะฐะฝััััั ะผะตะถะดั ะฟะตัะตะทะฐะฟััะบะฐะผะธ
- `--rm` โ ะบะพะฝัะตะนะฝะตั ัะดะฐะปะธััั ะฟัะธ ะพััะฐะฝะพะฒะบะต (ะดะปั ัะตััะพะฒ)

**ะจะฐะณ 2: ะะตัะฒัะน ะทะฐะฟััะบ**

1. ะัะบัะพะนัะต ะฑัะฐัะทะตั: **http://localhost:5678**
2. ะกะพะทะดะฐะนัะต ะฐะบะบะฐัะฝั (email + ะฟะฐัะพะปั)
3. ะะพัะพะฒะพ! ๐

### ะะฐัะธะฐะฝั B: NPM (ะะปััะตัะฝะฐัะธะฒะฐ)

```bash
# ะฃััะฐะฝะพะฒะบะฐ ะณะปะพะฑะฐะปัะฝะพ
npm install n8n -g

# ะะฐะฟััะบ
n8n start

# N8N ะพัะบัะพะตััั ะฝะฐ http://localhost:5678
```

### ะะฐัะธะฐะฝั C: Docker Compose (ะะปั ะฟัะพะดะฐะบัะฝ)

ะกะพะทะดะฐะนัะต ัะฐะนะป `docker-compose.yml`:

```yaml
version: '3.8'

services:
  n8n:
    image: docker.n8n.io/n8nio/n8n
    container_name: n8n
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=your-secure-password
      - TZ=Europe/Moscow
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```

ะะฐะฟััะบ:
```bash
docker-compose up -d
```

---

## ๐ ะะพะปััะตะฝะธะต API ัะพะบะตะฝะพะฒ

### 1. Google Sheets API

**ะฃ ะฒะฐั ัะถะต ะตััั!** ะัะฟะพะปัะทัะนัะต ัะพั ะถะต `credentials.json` ะธะท ะฟัะธะปะพะถะตะฝะธั.

**ะ N8N:**
1. **Credentials** โ **Add Credential** โ **Google Sheets API**
2. **Service Account** โ ะฒััะฐะฒััะต ัะพะดะตัะถะธะผะพะต `credentials.json`
3. **Save**

### 2. VK API Token

#### ะจะฐะณ 1: ะกะพะทะดะฐะฝะธะต ะฟัะธะปะพะถะตะฝะธั

1. ะะตัะตะนะดะธัะต: https://vk.com/apps?act=manage
2. **ะกะพะทะดะฐัั ะฟัะธะปะพะถะตะฝะธะต**
3. ะะฐะทะฒะฐะฝะธะต: `AI Content Studio`
4. ะะปะฐััะพัะผะฐ: **ะะตะฑ-ัะฐะนั**
5. ะะดัะตั ัะฐะนัะฐ: `https://your-domain.com` (ะผะพะถะฝะพ ะปัะฑะพะน)
6. **ะกะพะทะดะฐัั**

#### ะจะฐะณ 2: ะะพะปััะตะฝะธะต ัะพะบะตะฝะฐ ัะพะพะฑัะตััะฒะฐ

1. ะะตัะตะนะดะธัะต ะฒ **ะะฐัััะพะนะบะธ** โ **ะะฐะฑะพัะฐ ั API**
2. **ะกะพะทะดะฐัั ะบะปัั**
3. ะัะฐะฒะฐ:
   - โ **ะฃะฟัะฐะฒะปะตะฝะธะต ัะพะพะฑัะตััะฒะพะผ** (wall)
   - โ **ะคะพัะพะณัะฐัะธะธ** (photos)
4. **ะกะพะทะดะฐัั** โ ะกะบะพะฟะธััะนัะต ัะพะบะตะฝ

**ะคะพัะผะฐั ัะพะบะตะฝะฐ:** 
```
vk1.a.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
```

#### ะจะฐะณ 3: ะะพะปััะตะฝะธะต ID ัะพะพะฑัะตััะฒะฐ

URL ะฒะฐัะตะน ะณััะฟะฟั: `https://vk.com/club123456789`

ID: `-123456789` (ั ะผะธะฝััะพะผ!)

**ะ N8N:**
1. **Credentials** โ **Add Credential** โ **HTTP Header Auth**
2. Name: `VK API`
3. Header Name: `access_token`
4. Header Value: `ะะะจ_VK_TOKEN`

### 3. Telegram Bot Token

#### ะจะฐะณ 1: ะกะพะทะดะฐะฝะธะต ะฑะพัะฐ

1. ะะฐะนะดะธัะต ะฒ Telegram: **@BotFather**
2. ะัะฟัะฐะฒััะต: `/newbot`
3. ะะฒะตะดะธัะต ะธะผั: `ะกะฐะปะพะฝ ะจะฐัะผ Content Bot`
4. ะะฒะตะดะธัะต username: `sharm_content_bot`
5. ะกะบะพะฟะธััะนัะต ัะพะบะตะฝ

**ะคะพัะผะฐั ัะพะบะตะฝะฐ:**
```
1234567890:ABCdefGHIjklMNOpqrsTUVwxyz-1234567
```

#### ะจะฐะณ 2: ะะพะฑะฐะฒะปะตะฝะธะต ะฑะพัะฐ ะฒ ะบะฐะฝะฐะป

1. ะัะบัะพะนัะต ะฒะฐั ะบะฐะฝะฐะป/ะณััะฟะฟั ะฒ Telegram
2. **ะะฐัััะพะนะบะธ** โ **ะะดะผะธะฝะธัััะฐัะพัั** โ **ะะพะฑะฐะฒะธัั**
3. ะะฐะนะดะธัะต ะฒะฐัะตะณะพ ะฑะพัะฐ โ ะะพะฑะฐะฒััะต
4. ะัะฐะฒะฐ: **ะัะฑะปะธะบะฐัะธั ัะพะพะฑัะตะฝะธะน**

#### ะจะฐะณ 3: ะะพะปััะตะฝะธะต Chat ID

ะะฐัะธะฐะฝั A: ะงะตัะตะท ะฑะพัะฐ @userinfobot
1. ะะตัะตัะปะธัะต ะปัะฑะพะต ัะพะพะฑัะตะฝะธะต ะธะท ะบะฐะฝะฐะปะฐ ะฒ @userinfobot
2. ะกะบะพะฟะธััะนัะต `Chat ID`

ะะฐัะธะฐะฝั B: ะงะตัะตะท API
```bash
# ะะฐะผะตะฝะธัะต YOUR_BOT_TOKEN ะฝะฐ ะฒะฐั ัะพะบะตะฝ
curl https://api.telegram.org/botYOUR_BOT_TOKEN/getUpdates
```

**ะคะพัะผะฐั Chat ID:**
- ะัะฑะปะธัะฝัะน ะบะฐะฝะฐะป: `@channel_username`
- ะัะธะฒะฐัะฝัะน ะบะฐะฝะฐะป: `-100XXXXXXXXX`
- ะััะฟะฟะฐ: `-XXXXXXXXX`

**ะ N8N:**
1. **Credentials** โ **Add Credential** โ **Telegram API**
2. Access Token: `ะะะจ_TELEGRAM_TOKEN`
3. **Save**

### 4. YandexART API

#### ะจะฐะณ 1: ะะพะปััะตะฝะธะต API ะบะปััะฐ

1. ะะตัะตะนะดะธัะต: https://console.cloud.yandex.ru/
2. **ะกะพะทะดะฐัั ะบะฐัะฐะปะพะณ** (Folder)
3. ะกะบะพะฟะธััะนัะต **Folder ID** (ะฝะฐะฟัะธะผะตั: `b1g2abc3def4ghi5jklm`)
4. **ะกะตัะฒะธัั** โ **Yandex Foundation Models** โ **ะะบะปััะธัั**
5. **API ะบะปััะธ** โ **ะกะพะทะดะฐัั ะบะปัั API**
6. ะกะบะพะฟะธััะนัะต ะบะปัั

**ะคะพัะผะฐั ะบะปััะฐ:**
```
AQVNxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**ะ N8N:**
1. **Credentials** โ **Add Credential** โ **HTTP Header Auth**
2. Name: `Yandex API`
3. Header Name: `Authorization`
4. Header Value: `Api-Key ะะะจ_YANDEX_KEY`

---

## ๐๏ธ ะกะพะทะดะฐะฝะธะต Workflow

### ะจะฐะณ 1: ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ Workflow

1. ะ N8N โ **Workflows** โ **Add workflow**
2. ะะฐะทะฒะฐะฝะธะต: `Auto Publish Content`

### ะจะฐะณ 2: ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะด

#### ะะพะดะฐ 1: Schedule Trigger (Cron)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฐะฟััะบ workflow ะบะฐะถะดัะน ัะฐั

1. ะะตัะตัะฐัะธัะต **Schedule Trigger** ะฝะฐ ัะพะปัั
2. ะะฐัััะพะนะบะธ:
   - **Trigger Interval:** `Every Hour` (ะธะปะธ `Every 15 Minutes` ะดะปั ัะตััะพะฒ)
   - **Trigger Times:** ะพััะฐะฒััะต ะฟะพ ัะผะพะปัะฐะฝะธั

#### ะะพะดะฐ 2: Google Sheets (Read Content Plan)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะงัะตะฝะธะต ะฟะพััะพะฒ ัะพ ััะฐัััะพะผ Ready

1. ะะพะฑะฐะฒััะต **Google Sheets**
2. ะะฐัััะพะนะบะธ:
   - **Credential:** ะัะฑะตัะธัะต ัะพะทะดะฐะฝะฝัะน ัะฐะฝะตะต
   - **Operation:** `Read`
   - **Document:** ะฒััะฐะฒััะต `SHEET_ID`
   - **Sheet:** `Content_Plan`
   - **Range:** `A:H` (ะฒัะต ะบะพะปะพะฝะบะธ)
   - **Return All:** `true`

3. **Execute Node** โ ะัะพะฒะตัััะต ััะพ ะดะฐะฝะฝัะต ะทะฐะณััะถะฐัััั

#### ะะพะดะฐ 3: Filter (By Time and Status)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะััะฐะฒะธัั ัะพะปัะบะพ ะฟะพััั ะณะพัะพะฒัะต ะบ ะฟัะฑะปะธะบะฐัะธะธ

1. ะะพะฑะฐะฒััะต **Function**
2. JavaScript ะบะพะด:

```javascript
// ะะพะปััะฐะตะผ ัะตะบััะตะต ะฒัะตะผั
const now = new Date();

// ะคะธะปััััะตะผ ะฟะพััั
const readyPosts = items.filter(item => {
  // ะัะพะฒะตััะตะผ ััะฐััั
  if (item.json.Status !== 'Ready') {
    return false;
  }
  
  // ะัะพะฒะตััะตะผ ะฒัะตะผั ะฟัะฑะปะธะบะฐัะธะธ
  const publishTime = new Date(item.json.Publish_Time);
  
  // ะัะฑะปะธะบัะตะผ ะตัะปะธ ะฒัะตะผั ะฟัะธัะปะพ (ั ะทะฐะฟะฐัะพะผ 1 ัะฐั)
  return publishTime <= now;
});

return readyPosts;
```

#### ะะพะดะฐ 4: HTTP Request (YandexART - Start Generation)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฐะฟััะบ ะณะตะฝะตัะฐัะธะธ ะธะทะพะฑัะฐะถะตะฝะธั

1. ะะพะฑะฐะฒััะต **HTTP Request**
2. ะะฐัััะพะนะบะธ:
   - **Method:** `POST`
   - **URL:** `https://llm.api.cloud.yandex.net/foundationModels/v1/imageGenerationAsync`
   - **Authentication:** ะัะฑะตัะธัะต `Yandex API`
   - **Send Body:** `true`
   - **Body Content Type:** `JSON`
   - **Specify Body:** `Using JSON`

3. JSON Body:
```json
{
  "modelUri": "art://ะะะจ_FOLDER_ID/yandex-art/latest",
  "generationOptions": {
    "seed": "{{ $json.ID }}"
  },
  "messages": [
    {
      "weight": 1,
      "text": "{{ $json.Image_Prompt }}"
    }
  ]
}
```

**ะะฐะถะฝะพ:** ะะฐะผะตะฝะธัะต `ะะะจ_FOLDER_ID` ะฝะฐ ะฒะฐั Yandex Folder ID

#### ะะพะดะฐ 5: Wait (60 seconds)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะถะธะดะฐะฝะธะต ะณะตะฝะตัะฐัะธะธ ะธะทะพะฑัะฐะถะตะฝะธั

1. ะะพะฑะฐะฒััะต **Wait**
2. **Wait:** `60 seconds`

#### ะะพะดะฐ 6: HTTP Request (YandexART - Poll Result)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะพะปััะตะฝะธะต ัะตะทัะปััะฐัะฐ ะณะตะฝะตัะฐัะธะธ

1. ะะพะฑะฐะฒััะต **HTTP Request**
2. ะะฐัััะพะนะบะธ:
   - **Method:** `GET`
   - **URL:** `https://llm.api.cloud.yandex.net/operations/{{ $node["HTTP Request"].json["id"] }}`
   - **Authentication:** `Yandex API`

3. **Options** โ **Retry On Fail:**
   - **Max Tries:** `20`
   - **Wait Between Tries (ms):** `3000`

#### ะะพะดะฐ 7: Function (Extract Image)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะทะฒะปะตัะตะฝะธะต base64 ะธะทะพะฑัะฐะถะตะฝะธั

1. ะะพะฑะฐะฒััะต **Function**
2. JavaScript:

```javascript
// ะัะพะฒะตััะตะผ ััะพ ะณะตะฝะตัะฐัะธั ะทะฐะฒะตััะตะฝะฐ
if (!$input.item.json.done) {
  throw new Error('Image generation not completed');
}

// ะัะพะฒะตััะตะผ ะฝะฐะปะธัะธะต ะธะทะพะฑัะฐะถะตะฝะธั
if (!$input.item.json.response || !$input.item.json.response.image) {
  throw new Error('No image in response');
}

// ะะทะฒะปะตะบะฐะตะผ ะธะทะพะฑัะฐะถะตะฝะธะต
const imageBase64 = $input.item.json.response.image;

// ะะพะทะฒัะฐัะฐะตะผ ั ะดะพะฑะฐะฒะปะตะฝะธะตะผ ะดะฐะฝะฝัั ะฟะพััะฐ
return {
  json: {
    ...items[0].json, // ะะฐะฝะฝัะต ะธะท Google Sheets
    imageBase64: imageBase64
  }
};
```

#### ะะพะดะฐ 8: Split In Batches

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฑัะฐะฑะพัะบะฐ ะฟะพััะพะฒ ะฟะพ ะพะดะฝะพะผั

1. ะะพะฑะฐะฒััะต **Split In Batches**
2. **Batch Size:** `1`

#### ะะพะดะฐ 9: HTTP Request (Upload to VK)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฐะณััะทะบะฐ ะธะทะพะฑัะฐะถะตะฝะธั ะฝะฐ VK ัะตัะฒะตั

1. ะะพะฑะฐะฒััะต **HTTP Request**
2. ะะฐัััะพะนะบะธ:
   - **Method:** `GET`
   - **URL:** `https://api.vk.com/method/photos.getWallUploadServer`
   - **Send Query Parameters:** `true`

3. Query Parameters:
```
access_token: ะะะจ_VK_TOKEN
v: 5.131
group_id: ะะะจ_GROUP_ID (ะฑะตะท ะผะธะฝััะฐ)
```

#### ะะพะดะฐ 10: HTTP Request (Upload Photo to Server)

1. ะะพะฑะฐะฒััะต **HTTP Request**
2. **Method:** `POST`
3. **URL:** `{{ $node["HTTP Request - Get Upload Server"].json["response"]["upload_url"] }}`
4. **Send Body:** `true`
5. **Body Content Type:** `Multipart-Form Data`

Body Parameters:
```
photo: {{ $node["Extract Image"].json["imageBase64"] }}
```

#### ะะพะดะฐ 11: HTTP Request (Save Photo)

1. **Method:** `POST`
2. **URL:** `https://api.vk.com/method/photos.saveWallPhoto`

Query Parameters:
```
access_token: ะะะจ_VK_TOKEN
v: 5.131
group_id: ะะะจ_GROUP_ID
photo: {{ $node["Upload Photo"].json["photo"] }}
server: {{ $node["Upload Photo"].json["server"] }}
hash: {{ $node["Upload Photo"].json["hash"] }}
```

#### ะะพะดะฐ 12: HTTP Request (Post to VK Wall)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะัะฑะปะธะบะฐัะธั ะฟะพััะฐ ะฒ VK

1. ะะพะฑะฐะฒััะต **HTTP Request**
2. **Method:** `POST`
3. **URL:** `https://api.vk.com/method/wall.post`

Query Parameters:
```
access_token: ะะะจ_VK_TOKEN
v: 5.131
owner_id: -ะะะจ_GROUP_ID (ั ะผะธะฝััะพะผ!)
message: {{ $node["Split In Batches"].json["VK_Text"] }}
attachments: photo{{ $node["Save Photo"].json["response"][0]["owner_id"] }}_{{ $node["Save Photo"].json["response"][0]["id"] }}
```

#### ะะพะดะฐ 13: Telegram (Send Photo)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะัะฑะปะธะบะฐัะธั ะฒ Telegram

1. ะะพะฑะฐะฒััะต **Telegram**
2. **Credential:** ะัะฑะตัะธัะต Telegram API
3. **Resource:** `Message`
4. **Operation:** `Send Photo`
5. ะะฐัััะพะนะบะธ:
   - **Chat ID:** `ะะะจ_CHAT_ID`
   - **Photo:** `{{ $node["Extract Image"].json["imageBase64"] }}`
   - **Caption:** `{{ $node["Split In Batches"].json["TG_Text"] }}`
   - **Parse Mode:** `Markdown`

#### ะะพะดะฐ 14: Google Sheets (Update Status)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฑะฝะพะฒะปะตะฝะธะต ััะฐัััะฐ ะฝะฐ Published

1. ะะพะฑะฐะฒััะต **Google Sheets**
2. **Operation:** `Update`
3. ะะฐัััะพะนะบะธ:
   - **Document:** `SHEET_ID`
   - **Sheet:** `Content_Plan`
   - **Range:** `C{{ $node["Split In Batches"].json["__rowNum"] + 1 }}` (ััะพะปะฑะตั Status)
   - **Data:** `Published`

#### ะะพะดะฐ 15: Merge (Back to Split)

1. ะะพะฑะฐะฒััะต **Merge**
2. ะกะพะตะดะธะฝะธัะต ั **Split In Batches** ะดะปั ะพะฑัะฐะฑะพัะบะธ ัะปะตะดัััะตะณะพ ะฟะพััะฐ

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั 1: ะงัะตะฝะธะต Google Sheets

1. ะะฐะฟัััะธัะต ะฝะพะดั **Google Sheets (Read)**
2. ะัะพะฒะตัััะต ััะพ ะฒะธะดะฝั ะฟะพััั ะธะท ัะฐะฑะปะธัั
3. ะะพะปะถะฝั ะฑััั ะฒัะต ะบะพะปะพะฝะบะธ: ID, Publish_Time, Status, etc.

### ะขะตัั 2: ะคะธะปัััะฐัะธั

1. ะ ัะฐะฑะปะธัะต ัะพะทะดะฐะนัะต ัะตััะพะฒัะน ะฟะพัั:
   - Status: `Ready`
   - Publish_Time: ัะตะบััะตะต ะฒัะตะผั ะผะธะฝัั 10 ะผะธะฝัั
2. ะะฐะฟัััะธัะต **Filter** ะฝะพะดั
3. ะะพัั ะดะพะปะถะตะฝ ะฟัะพะนัะธ ัะธะปััั

### ะขะตัั 3: ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธั

1. ะัะฟะพะปัะทัะนัะต ะฟัะพััะพะน ะฟัะพะผะฟั: `"ะัะฐัะธะฒัะน ัะฐะปะพะฝ ะบัะฐัะพัั"`
2. ะะฐะฟัััะธัะต YandexART ะฝะพะดั
3. ะัะพะฒะตัััะต ััะพ ะธะทะพะฑัะฐะถะตะฝะธะต ัะณะตะฝะตัะธัะพะฒะฐะปะพัั (base64)

### ะขะตัั 4: ะัะฑะปะธะบะฐัะธั ะฒ VK (ะพะฟัะธะพะฝะฐะปัะฝะพ)

โ๏ธ **ะะฝะธะผะฐะฝะธะต:** ะญัะพ ะพะฟัะฑะปะธะบัะตั ัะตะฐะปัะฝัะน ะฟะพัั!

1. ะกะพะทะดะฐะนัะต ัะตััะพะฒัั ะณััะฟะฟั VK
2. ะะฐะฟัััะธัะต VK ะฝะพะดั
3. ะัะพะฒะตัััะต ััะพ ะฟะพัั ะฟะพัะฒะธะปัั ะฝะฐ ััะตะฝะต

### ะขะตัั 5: ะัะฑะปะธะบะฐัะธั ะฒ Telegram

1. ะกะพะทะดะฐะนัะต ัะตััะพะฒัะน ะบะฐะฝะฐะป
2. ะะฐะฟัััะธัะต Telegram ะฝะพะดั
3. ะัะพะฒะตัััะต ะฟัะฑะปะธะบะฐัะธั

### ะขะตัั 6: ะะพะปะฝัะน Workflow

1. ะะฐะถะผะธัะต **Execute Workflow**
2. ะกะปะตะดะธัะต ะทะฐ ะฒัะฟะพะปะฝะตะฝะธะตะผ ะบะฐะถะดะพะน ะฝะพะดั
3. ะัะพะฒะตัััะต:
   - โ ะะพัั ะพะฟัะฑะปะธะบะพะฒะฐะฝ ะฒ VK
   - โ ะะพัั ะพะฟัะฑะปะธะบะพะฒะฐะฝ ะฒ Telegram
   - โ ะกัะฐััั ะฒ ัะฐะฑะปะธัะต = Published

---

## ๐ ะะฐะฟััะบ ะฒ ะฟัะพะดะฐะบัะฝ

### ะะฐัะธะฐะฝั A: ะะพะบะฐะปัะฝัะน ัะตัะฒะตั (24/7)

**ะขัะตะฑะพะฒะฐะฝะธั:**
- ะะพะผะฟัััะตั/ัะตัะฒะตั ัะฐะฑะพัะฐะตั ะฟะพััะพัะฝะฝะพ
- ะกัะฐะฑะธะปัะฝัะน ะธะฝัะตัะฝะตั

**Docker Compose:**
```yaml
version: '3.8'

services:
  n8n:
    image: docker.n8n.io/n8nio/n8n
    container_name: n8n-production
    restart: always
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=secure-password-here
      - WEBHOOK_URL=https://your-domain.com
      - TZ=Europe/Moscow
      - N8N_ENCRYPTION_KEY=your-random-encryption-key
    volumes:
      - ./n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```

ะะฐะฟััะบ:
```bash
docker-compose up -d
```

### ะะฐัะธะฐะฝั B: ะะฑะปะฐะบะพ N8N

1. ะะฐัะตะณะธัััะธััะนัะตัั: https://n8n.cloud/
2. ะะปะฐะฝ: **Starter** ($20/ะผะตััั) ะธะปะธ **Pro** ($50/ะผะตััั)
3. ะะผะฟะพััะธััะนัะต workflow (Export โ Import)
4. ะะฐัััะพะนัะต credentials
5. ะะบัะธะฒะธััะนัะต workflow

### ะะฐัะธะฐะฝั C: Self-hosted ะฝะฐ VPS

**ะะตะบะพะผะตะฝะดัะตะผัะต ะฟัะพะฒะฐะนะดะตัั:**
- DigitalOcean (ะพั $6/ะผะตั)
- Hetzner (ะพั โฌ4/ะผะตั)
- AWS/Google Cloud (ะพั $5/ะผะตั)

**ะะธะฝะธะผะฐะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั:**
- 1 vCPU
- 1 GB RAM
- 10 GB SSD

**ะฃััะฐะฝะพะฒะบะฐ:**
```bash
# ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั
ssh user@your-server-ip

# ะฃััะฐะฝะพะฒะบะฐ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# ะฃััะฐะฝะพะฒะบะฐ Docker Compose
sudo apt install docker-compose

# ะะปะพะฝะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ
git clone https://your-repo.git
cd ai-content-studio

# ะะฐะฟััะบ N8N
docker-compose -f n8n-docker-compose.yml up -d
```

---

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะัะพะฑะปะตะผะฐ 1: "ะะทะพะฑัะฐะถะตะฝะธะต ะฝะต ะณะตะฝะตัะธััะตััั"

**ะกะธะผะฟัะพะผั:**
- Timeout ะฝะฐ YandexART ะฝะพะดะฐั
- ะัะธะฑะบะฐ 403/401

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต API ะบะปัั Yandex
2. ะัะพะฒะตัััะต Folder ID
3. ะฃะฑะตะดะธัะตัั ััะพ Foundation Models ะฒะบะปััะตะฝ
4. ะัะพะฒะตัััะต ะฑะฐะปะฐะฝั ะฒ Yandex Cloud

### ะัะพะฑะปะตะผะฐ 2: "VK ะฝะต ะฟัะฑะปะธะบัะตั ะฟะพััั"

**ะกะธะผะฟัะพะผั:**
- ะัะธะฑะบะฐ "Invalid access_token"
- ะัะธะฑะบะฐ "Access denied"

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ัะพะบะตะฝะฐ (wall, photos)
2. ะัะพะฒะตัััะต owner_id (ะดะพะปะถะตะฝ ะฑััั ั ะผะธะฝััะพะผ!)
3. ะฃะฑะตะดะธัะตัั ััะพ ัะพะบะตะฝ ัะพะพะฑัะตััะฒะฐ, ะฐ ะฝะต ะฟะพะปัะทะพะฒะฐัะตะปั

### ะัะพะฑะปะตะผะฐ 3: "Telegram ะฝะต ะฝะฐัะพะดะธั ะบะฐะฝะฐะป"

**ะกะธะผะฟัะพะผั:**
- "Chat not found"
- "Forbidden"

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต Chat ID (ะดะปั ะฟัะธะฒะฐัะฝัั: `-100XXXXXXXXX`)
2. ะฃะฑะตะดะธัะตัั ััะพ ะฑะพั ะดะพะฑะฐะฒะปะตะฝ ะฒ ะบะฐะฝะฐะป ะบะฐะบ ะฐะดะผะธะฝะธัััะฐัะพั
3. ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะฑะพัะฐ ะฝะฐ ะฟัะฑะปะธะบะฐัะธั

### ะัะพะฑะปะตะผะฐ 4: "Google Sheets - Permission Denied"

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ััะพ ัะตัะฒะธัะฝัะน ะฐะบะบะฐัะฝั ะธะผะตะตั ะดะพัััะฟ ะบ ัะฐะฑะปะธัะต
2. Email ะธะท credentials.json ะดะพะปะถะตะฝ ะฑััั ะฒ ัะฟะธัะบะต ัะตะดะฐะบัะพัะพะฒ
3. ะะตัะตะทะฐะณััะทะธัะต credentials ะฒ N8N

### ะัะพะฑะปะตะผะฐ 5: "Workflow ะฝะต ะทะฐะฟััะบะฐะตััั ะฟะพ ัะฐัะฟะธัะฐะฝะธั"

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ััะพ workflow **Activated** (ะฟะตัะตะบะปััะฐัะตะปั ะฒะฒะตััั)
2. ะัะพะฒะตัััะต ะฝะฐัััะพะนะบะธ Cron ะฒ Schedule Trigger
3. ะัะพะฒะตัััะต ัะฐัะพะฒะพะน ะฟะพัั (TZ ะฒ docker-compose)

### ะัะพะฑะปะตะผะฐ 6: "ะะพััั ะดัะฑะปะธัััััั"

**ะัะธัะธะฝะฐ:** Workflow ะทะฐะฟัััะธะปัั ะดะฒะฐะถะดั ะดะพ ะพะฑะฝะพะฒะปะตะฝะธั ััะฐัััะฐ

**ะะตัะตะฝะธะต:**
1. ะฃะผะตะฝััะธัะต ัะฐััะพัั ะทะฐะฟััะบะฐ (1 ัะฐะท ะฒ ัะฐั ะฒะผะตััะพ 15 ะผะธะฝัั)
2. ะะพะฑะฐะฒััะต ะฑะปะพะบะธัะพะฒะบั ะฒ ะฝะฐัะฐะปะพ workflow:

```javascript
// ะ ะฝะฐัะฐะปะต Filter ะฝะพะดั
const lastRun = await this.helpers.getWorkflowStaticData('global');
const now = Date.now();

// ะะปะพะบะธัะพะฒะบะฐ ะฝะฐ 5 ะผะธะฝัั
if (lastRun.timestamp && (now - lastRun.timestamp) < 300000) {
  return [];
}

lastRun.timestamp = now;
```

---

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะัะพะฒะตัะบะฐ ััะฐัััะฐ

**ะ N8N:**
- **Executions** โ ะััะพัะธั ะทะฐะฟััะบะพะฒ
- ะะตะปะตะฝัะน โ โ ััะฟะตัะฝะพ
- ะัะฐัะฝัะน โ โ ะพัะธะฑะบะฐ

**ะ Google Sheets:**
- ะัะพะฒะตััะนัะต ะบะพะปะพะฝะบั Status
- Ready โ Published ะพะทะฝะฐัะฐะตั ััะฟะตัะฝัั ะฟัะฑะปะธะบะฐัะธั

### ะฃะฒะตะดะพะผะปะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

ะะพะฑะฐะฒััะต ะฒ ะบะพะฝะตั workflow ะฝะพะดั **Error Trigger**:

1. **Error Trigger**
2. **Telegram** โ ะพัะฟัะฐะฒะธัั ัะพะพะฑัะตะฝะธะต ะฒะฐะผ
3. ะขะตะบัั: `โ ะัะธะฑะบะฐ ะฒ ะฐะฒัะพะฟัะฑะปะธะบะฐัะธะธ: {{ $json.error.message }}`

---

## ๐ฏ ะะฟัะธะผะธะทะฐัะธั

### ะญะบะพะฝะพะผะธั ะฝะฐ YandexART

**ะกัะพะธะผะพััั:** ~โฝ1 ะทะฐ ะธะทะพะฑัะฐะถะตะฝะธะต

**ะกะพะฒะตั:** ะัะฟะพะปัะทัะนัะต ะบัั ะธะทะพะฑัะฐะถะตะฝะธะน:
1. ะกะพััะฐะฝัะนัะต URL ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัั ะธะทะพะฑัะฐะถะตะฝะธะน
2. ะะปั ะฟะพัะพะถะธั ะฟัะพะผะฟัะพะฒ ะธัะฟะพะปัะทัะนัะต ััะฐััะต ะธะทะพะฑัะฐะถะตะฝะธั

### ะฃัะบะพัะตะฝะธะต workflow

1. **ะะฐัะฐะปะปะตะปัะฝะฐั ะฟัะฑะปะธะบะฐัะธั:**
   - VK ะธ Telegram ะฟัะฑะปะธะบัะนัะต ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
   - ะัะฟะพะปัะทัะนัะต ะฝะพะดั **Merge**

2. **Batch processing:**
   - ะะฑัะฐะฑะฐััะฒะฐะนัะต ะฝะตัะบะพะปัะบะพ ะฟะพััะพะฒ ะทะฐ ัะฐะท
   - ะะฐัััะพะนัะต Split In Batches ั Batch Size = 3

---

## โ ะงะตะบะปะธัั ะทะฐะฟััะบะฐ

- [ ] N8N ัััะฐะฝะพะฒะปะตะฝ ะธ ะทะฐะฟััะตะฝ
- [ ] ะัะต credentials ะฝะฐัััะพะตะฝั:
  - [ ] Google Sheets API
  - [ ] VK API Token
  - [ ] Telegram Bot Token
  - [ ] YandexART API Key
- [ ] Workflow ัะพะทะดะฐะฝ ะธ ะฒัะต ะฝะพะดั ะฟะพะดะบะปััะตะฝั
- [ ] ะขะตััะพะฒัะน ะฟะพัั ััะฟะตัะฝะพ ะพะฟัะฑะปะธะบะพะฒะฐะฝ
- [ ] Schedule Trigger ะฝะฐัััะพะตะฝ (ะบะฐะถะดัะน ัะฐั)
- [ ] Workflow ะฐะบัะธะฒะธัะพะฒะฐะฝ
- [ ] ะะพะฝะธัะพัะธะฝะณ ะฝะฐัััะพะตะฝ

---

**ะะพัะพะฒะพ! ะะฒัะพะฟัะฑะปะธะบะฐัะธั ัะฐะฑะพัะฐะตั! ๐**

ะขะตะฟะตัั AI Content Studio ะฟะพะปะฝะพัััั ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝ:
1. โ ะกะพะทะดะฐะฝะธะต ะฟะพััะพะฒ ัะตัะตะท ะฒะตะฑ-ะธะฝัะตััะตะนั
2. โ ะะปะฐะฝะธัะพะฒะฐะฝะธะต ะฒ Google Sheets
3. โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟัะฑะปะธะบะฐัะธั ัะตัะตะท N8N

**ะกะปะตะดัััะธะน ัะฐะณ:** Deployment Streamlit ะฝะฐ ะพะฑะปะฐะบะพ (Streamlit Cloud, Railway)